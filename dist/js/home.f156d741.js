(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home"],{"31c5":function(e,t,i){"use strict";var a=i("39d1"),s=i.n(a);s.a},"39d1":function(e,t,i){},"4a78":function(e,t,i){},"5c5a":function(e,t,i){},7016:function(e,t,i){"use strict";var a=i("b829"),s=i.n(a);s.a},"77c5":function(e,t,i){"use strict";(function(e){var a=i("5ef3"),s={selectFolder:function(e,t){return new Promise((function(i){if("open"===e)a["a"].remote.dialog.showOpenDialog({properties:["openDirectory"]},i);else{var s=new Date,n="search_result_".concat(s.getFullYear(),"_").concat(s.getMonth()+1,"_").concat(s.getDate(),"_by_").concat(t);a["a"].remote.dialog.showSaveDialog({defaultPath:n},i)}}))},search:function(e){return a["a"].req({name:"search",params:e})},searchBySql:function(e){return a["a"].req({name:"search/sql",params:e})},toggleFullscreen:function(){var t=a["a"].remote.getCurrentWindow(),i=t.isFullScreen();"win32"===e.platform&&t.setMenuBarVisibility(i),t.setFullScreen(!i)},exportToFolder:function(e){return a["a"].req({name:"exportToFolder",params:e})},showContextMenu:function(e){var t=[{label:"打开文件",click:function(){a["a"].shell.openItem(e.n)}},{label:"打开文件所在文件夹",click:function(){a["a"].shell.showItemInFolder(e.n)}}],i=a["a"].remote.Menu.buildFromTemplate(t);i.popup(a["a"].remote.getCurrentWindow())}};t["a"]=s}).call(this,i("f28c"))},b40a:function(e,t,i){"use strict";var a=i("5c5a"),s=i.n(a);s.a},b829:function(e,t,i){},bb51:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[i("Search",{attrs:{searchFolder:e.searchFolder,isLoading:e.isLoading,canPlayOrExport:e.canPlayOrExport},on:{selectSearchFolder:e.selectSearchFolder,inputSearchFolder:e.inputSearchFolder,search:e.search,searchBySql:e.searchBySql,imagePlayerTrigger:e.imagePlayerTrigger,toggleFullscreen:e.toggleFullscreen,exportTo:e.exportTo}}),i("div",{staticClass:"line"}),i("FileDisplay",{attrs:{searchFolder:e.searchFolder,outputData:e.outputData,selectedIndex:e.selectedIndex},on:{fileClick:e.fileClick,contextMenuClick:e.contextMenuClick}}),i("ImagePlayer",{attrs:{imagePlay:e.imagePlay,outputData:e.outputData},on:{imagePlayerTrigger:e.imagePlayerTrigger}})],1)},s=[],n=(i("8e6e"),i("ac6a"),i("456d"),i("386d"),i("bd86")),o=i("77c5"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row search"},[i("div",{staticClass:"col conditions"},[i("el-form",[i("el-form-item",[i("el-radio",{attrs:{label:"pixel"},model:{value:e.form.conditionType,callback:function(t){e.$set(e.form,"conditionType",t)},expression:"form.conditionType"}},[e._v("像素")]),i("el-input",{staticClass:"conditionInput",attrs:{placeholder:"宽",disabled:"pixel"!==e.form.conditionType,clearable:""},model:{value:e.form.w,callback:function(t){e.$set(e.form,"w",e._n(t))},expression:"form.w"}}),i("el-input",{staticClass:"conditionInput",attrs:{placeholder:"高",disabled:"pixel"!==e.form.conditionType,clearable:""},model:{value:e.form.h,callback:function(t){e.$set(e.form,"h",e._n(t))},expression:"form.h"}})],1),i("el-form-item",[i("el-radio",{attrs:{label:"ratio"},model:{value:e.form.conditionType,callback:function(t){e.$set(e.form,"conditionType",t)},expression:"form.conditionType"}},[e._v("比例")]),i("el-input",{staticClass:"conditionInput",attrs:{placeholder:"宽",disabled:"ratio"!==e.form.conditionType,clearable:""},model:{value:e.form.rw,callback:function(t){e.$set(e.form,"rw",e._n(t))},expression:"form.rw"}}),i("el-input",{staticClass:"conditionInput",attrs:{placeholder:"高",disabled:"ratio"!==e.form.conditionType,clearable:""},model:{value:e.form.rh,callback:function(t){e.$set(e.form,"rh",e._n(t))},expression:"form.rh"}})],1)],1)],1),i("div",{staticClass:"col options"},[i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"搜索文件夹"}},[e.$IS_E?[i("el-button",{attrs:{size:"small",onfocus:"blur()"},on:{click:e.selectSearchFolder}},[e._v("选择")]),i("span",[e._v(" "+e._s(this.searchFolder))])]:i("div",{staticClass:"row align-items-center"},[i("el-radio",{attrs:{label:"db"},model:{value:e.form.searchFolderType,callback:function(t){e.$set(e.form,"searchFolderType",t)},expression:"form.searchFolderType"}},[e._v("数据库")]),i("el-radio",{attrs:{label:"input"},model:{value:e.form.searchFolderType,callback:function(t){e.$set(e.form,"searchFolderType",t)},expression:"form.searchFolderType"}},[e._v("输入")]),i("div",{staticClass:"flex-1"},[i("el-input",{attrs:{placeholder:"文件夹路径",disabled:"db"===e.form.searchFolderType,clearable:""},on:{blur:e.folderTempInputBlur},model:{value:e.searchFolderTemp,callback:function(t){e.searchFolderTemp=t},expression:"searchFolderTemp"}})],1)],1)],2),i("el-form-item",{attrs:{label:""}},[i("el-button",{staticClass:"submitButton",attrs:{onfocus:"blur()",loading:e.isLoading},on:{click:e.search}},[e._v(e._s(e.isLoading?"运行中":"开始"))]),e._v("\n         \n        "),i("el-button",{staticClass:"sqlButton",attrs:{onfocus:"blur()",disabled:"db"!==e.form.searchFolderType},on:{click:function(t){e.dialogSqlVisible=!0}}},[e._v("自定义sql")]),e._v("\n         \n        "),i("el-button",{staticClass:"fullscreenButton",attrs:{onfocus:"blur()"},on:{click:e.toggleFullscreen}},[e._v("切换全屏")]),e._v("\n         \n        "),i("el-button",{staticClass:"playButton",attrs:{onfocus:"blur()",disabled:!e.canPlayOrExport},on:{click:e.imagePlayerTrigger}},[e._v("播放图片")]),e._v("\n         \n        "),i("el-button",{staticClass:"exportButton",attrs:{onfocus:"blur()",disabled:!e.canPlayOrExport},on:{click:e.exportTo}},[e._v("导出到文件夹")])],1)],1),i("el-dialog",{attrs:{title:"自定义查询",visible:e.dialogSqlVisible},on:{"update:visible":function(t){e.dialogSqlVisible=t}}},[i("el-input",{attrs:{placeholder:"输入sql条件",clearable:""},model:{value:e.sqlCondition,callback:function(t){e.sqlCondition=t},expression:"sqlCondition"}}),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogSqlVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogSqlVisible=!1,e.searchBySql()}}},[e._v("确 定")])],1)],1)],1)])},r=[],c={name:"Search",props:["searchFolder","isLoading","canPlayOrExport"],data:function(){return{form:{conditionType:"pixel",w:"1920",h:"1080",rw:"16",rh:"9",searchFolderType:""},searchFolderTemp:"",outputData:null,dialogSqlVisible:!1,sqlCondition:""}},mounted:function(){this.$IS_E||(this.form.searchFolderType="db")},methods:{selectSearchFolder:function(){this.$emit("selectSearchFolder")},folderTempInputBlur:function(){this.$emit("inputSearchFolder",this.searchFolderTemp)},search:function(){"db"===this.form.searchFolderType||this.searchFolder?this.$emit("search",this.form):this.$notify({title:"提示",message:"请".concat(this.$IS_E?"选择":"输入","要搜索的文件夹"),duration:1500})},imagePlayerTrigger:function(){this.$emit("imagePlayerTrigger",!0)},toggleFullscreen:function(){this.$emit("toggleFullscreen")},exportTo:function(){this.$emit("exportTo")},searchBySql:function(){this.$emit("searchBySql",this.sqlCondition)}}},u=c,d=(i("b40a"),i("2877")),m=Object(d["a"])(u,l,r,!1,null,"d595c2ec",null),h=m.exports,p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.imagePlay,expression:"imagePlay"}],staticClass:"imagePlayer",on:{click:e.clickAct}},[i("div",{staticClass:"progress"},[i("div",{staticClass:"stroke",style:{"transition-duration":e.progressTransTime+"ms",width:e.strokeWidth+"%"}})]),e._l(e.imageList,(function(t,a){return i("img",{key:a,staticClass:"image",class:{image_show:t.isShow},style:{transition:"opacity "+e.imageTransTime+"ms"},attrs:{draggable:"false",src:t.src}})})),i("div",{staticClass:"playerController",class:{playerController_hover:e.isShowControllerByClick}},[i("div",{staticClass:"item"},[i("i",{staticClass:"el-icon-setting",on:{click:function(t){return t.stopPropagation(),e.showSetting(t)}}})]),i("div",{staticClass:"item"},[i("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.closePlayer(t)}}})])]),i("div",{staticClass:"playerSettings",class:{playerSetting_show:e.isShowSetting}},[i("div",[i("span",[e._v("停留时间 ")]),i("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,size:"mini"},model:{value:e.imageStayTime,callback:function(t){e.imageStayTime=t},expression:"imageStayTime"}})],1),i("div",{staticClass:"confirm-button"},[i("el-button",{attrs:{onfocus:"blur()",size:"mini",type:"text"},on:{click:function(t){return e.settingConfirm(!0)}}},[e._v("确定")]),i("el-button",{attrs:{onfocus:"blur()",size:"mini",type:"text"},on:{click:e.settingConfirm}},[e._v("取消")])],1)])],2)},f=[],g={name:"ImagePlayer",props:["imagePlay","outputData"],data:function(){return{imageList:[],imagePlayIndex:1,imagePlayInterval:null,imageStayTime:parseInt(window.localStorage.getItem("image_stay")||3),imageTransTime:500,isShowControllerByClick:!1,autoFadeTimer:null,isShowSetting:!1,strokeWidth:0,strokeTransTimeFlag:!1}},computed:{progressTransTime:function(){return this.strokeTransTimeFlag?1e3*this.imageStayTime+this.imageTransTime:0}},methods:{clickAct:function(){var e=this;this.isShowControllerByClick=!0,clearTimeout(this.autoFadeTimer),this.autoFadeTimer=setTimeout((function(){e.isShowControllerByClick=!1}),2e3)},showSetting:function(){this.isShowSetting=!this.isShowSetting},closePlayer:function(){this.$emit("imagePlayerTrigger",!1)},settingConfirm:function(e){e&&(window.localStorage.setItem("image_stay",this.imageStayTime),clearInterval(this.imagePlayInterval),this.imagePlayInterval=setInterval(this.intervalFun,this.getIntervalTime())),this.isShowSetting=!1},intervalFun:function(){var e,t,i=this;this.imagePlayIndex+=1,this.imagePlayIndex===this.outputData.length&&(this.imagePlayIndex=0),this.imageList.forEach((function(i,a){var s=i;s.isShow?(s.isShow=!1,e=a):t=a})),this.strokeWidth=0,this.strokeTransTimeFlag=!1,setTimeout((function(){i.imageList[e].src=i.outputData[i.imagePlayIndex].sn,i.imageList[t].isShow=!0,i.strokeWidth=100,i.strokeTransTimeFlag=!0}),this.imageTransTime)},getIntervalTime:function(){return 1e3*this.imageStayTime+2*this.imageTransTime}},watch:{imagePlay:function(){var e=this;this.imagePlay?this.imagePlayInterval=setInterval(this.intervalFun,this.getIntervalTime()):(clearInterval(this.imagePlayInterval),this.strokeWidth=0,this.strokeTransTimeFlag=!1),this.$nextTick((function(){var t=(e.imagePlayIndex+1)%2;e.imageList[t].isShow=e.imagePlay,e.imagePlay&&(e.strokeWidth=100,e.strokeTransTimeFlag=!0)}))},outputData:function(){var e=this;this.imageList=[],this.outputData&&Array.isArray(this.outputData)&&this.outputData.forEach((function(t,i){i<2&&e.imageList.push({isShow:!1,src:t.sn})}))}}},v=g,y=(i("ef19"),Object(d["a"])(v,p,f,!1,null,"2d9cae2a",null)),w=y.exports,b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fileDisplay"},[i("div",{staticClass:"displaySetting"},[i("el-radio",{attrs:{label:"tile"},model:{value:e.displayType,callback:function(t){e.displayType=t},expression:"displayType"}},[e._v("平铺")]),i("el-radio",{attrs:{label:"list"},model:{value:e.displayType,callback:function(t){e.displayType=t},expression:"displayType"}},[e._v("列表")])],1),i("div",{staticClass:"line"}),i("div",{directives:[{name:"show",rawName:"v-show",value:"tile"===e.displayType,expression:"displayType === 'tile'"}],staticClass:"window mini_files",class:{windows_scrollbar:e.isWindows}},[i("div",{staticClass:"row justify-content-between"},[e._l(e.outputData,(function(t,a){return i("div",{key:t.n,staticClass:"mini_file col",class:{selected:e.selectedIndex===a},on:{click:function(t){return e.fileClick(a)},contextmenu:function(i){return e.fileClick(a,t)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.sn,expression:"file.sn"}],attrs:{draggable:"false"}})])})),e._l(e.placeholderCount,(function(e){return i("div",{key:"mfp"+e,staticClass:"mini_file_placeholder col"})}))],2)]),i("div",{directives:[{name:"show",rawName:"v-show",value:"list"===e.displayType,expression:"displayType === 'list'"}],staticClass:"row"},[i("div",{ref:"scrollBody",staticClass:"window files col",class:{windows_scrollbar:e.isWindows}},e._l(e.outputData,(function(t,a){return i("div",{key:a,staticClass:"file",class:{selected:e.selectedIndex===a},on:{click:function(t){return e.fileClick(a)},contextmenu:function(i){return e.fileClick(a,t)}}},[e._v("\n        "+e._s(e.getFilePath(t.n))+"\n      ")])})),0),i("div",{staticClass:"window image col"},[e.outputData&&-1!==e.selectedIndex?i("ImagePreview",{attrs:{imgObj:e.outputData[e.selectedIndex]}}):e._e()],1)]),e.previewImage?i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowPreview,expression:"isShowPreview"}],staticClass:"image_preview"},[i("ImagePreview",{attrs:{imgObj:e.previewImage},on:{imgClick:e.closePreview}})],1):e._e()])},T=[],C=(i("a481"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row preview"},[i("div",{staticClass:"image_pic col",on:{click:e.imgClick}},[i("img",{attrs:{src:e.imgObj.sn,draggable:"false"}})]),i("div",{staticClass:"image_desc col"},[i("div",[e._v(e._s(e.getFileName(e.imgObj.n)))]),i("div",[e._v(e._s(e.imgObj.w+"x"+e.imgObj.h))])])])}),F=[],S={name:"ImagePreview",props:["imgObj"],data:function(){return{}},methods:{getFileName:function(e){return e.slice(e.lastIndexOf("/")+1)},imgClick:function(){this.$emit("imgClick")}}},x=S,_=(i("d0b2"),Object(d["a"])(x,C,F,!1,null,"4ddd6810",null)),k=_.exports,P={name:"FileDisplay",components:{ImagePreview:k},props:["searchFolder","outputData","selectedIndex"],data:function(){return{displayType:"tile",scrollVal:0,placeholderCount:20,isShowPreview:!1,previewImage:null}},mounted:function(){var e=this;document.addEventListener("keydown",(function(t){switch(t.keyCode){case 32:e.selectedIndex>-1&&(e.isShowPreview=!e.isShowPreview,e.isShowPreview?e.previewImage=e.outputData[e.selectedIndex]:e.previewImage=null,t.preventDefault(),t.stopPropagation());break;case 27:e.isShowPreview&&e.closePreview();break}}))},methods:{fileClick:function(e,t){this.$emit("fileClick",e),t&&this.$emit("contextMenuClick",t)},getFilePath:function(e){return e.replace(this.searchFolder.replace(/\\/g,"/"),"")},getFileName:function(e){return e.slice(e.lastIndexOf("/")+1)},closePreview:function(){this.isShowPreview=!1,this.previewImage=null}},computed:{isWindows:function(){return"win32"===this.$PLATFORM}}},I=P,O=(i("7016"),Object(d["a"])(I,b,T,!1,null,"fd2bcc8e",null)),$=O.exports;function D(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?D(i,!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var j=function(e){return function(t){var i=t.msg||t;t&&Array.isArray(t.images)?(e.outputData=t.images.map((function(t){return q({sn:e.$getImgPath(t.n)},t)})),e.outputData.length>0?e.canPlayOrExport=!0:i=t.msg+"查询结果为空"):i=i||"未知错误","success"!==i&&e.$notify({title:"提示",message:i,duration:1500}),e.isLoading=!1}},E={name:"Home",components:{ImagePlayer:w,Search:h,FileDisplay:$},data:function(){return{searchFolder:"",outputData:[],selectedIndex:-1,isLoading:!1,canPlayOrExport:!1,imagePlay:!1,nowConditions:{}}},methods:{selectSearchFolder:function(){var e=this;this.$IS_E_NOTIFY()&&o["a"].selectFolder("open").then((function(t){e.searchFolder="",t&&t.length>0&&(e.searchFolder=t[0])}))},inputSearchFolder:function(e){this.searchFolder=e},search:function(e){this.isLoading=!0,this.selectedIndex=-1,this.nowConditions=q({},e);var t=Object.assign({searchFolder:this.searchFolder},e),i=j(this);o["a"].search(t).then(i).catch((function(e){console.log(e)}))},searchBySql:function(e){this.isLoading=!0,this.selectedIndex=-1;var t=j(this);o["a"].searchBySql({sql:e}).then(t).catch((function(e){console.log(e)}))},toggleFullscreen:function(){this.$IS_E_NOTIFY()&&o["a"].toggleFullscreen()},exportTo:function(){var e=this;if(this.$IS_E_NOTIFY()){var t=this.nowConditions.w?this.nowConditions.w+"-"+this.nowConditions.h:this.nowConditions.rw+"-"+this.nowConditions.rh;o["a"].selectFolder("save",t).then((function(t){if(t&&t.length>0){var i={data:e.outputData,folderPath:t};o["a"].exportToFolder(i).then((function(){e.$notify({title:"提示",message:"导出成功",duration:1500})}))}}))}},imagePlayerTrigger:function(e){this.imagePlay=e},fileClick:function(e){this.selectedIndex=e},contextMenuClick:function(e){this.$IS_E&&o["a"].showContextMenu(e)}}},B=E,L=(i("31c5"),Object(d["a"])(B,a,s,!1,null,"054061aa",null));t["default"]=L.exports},d0b2:function(e,t,i){"use strict";var a=i("ea86"),s=i.n(a);s.a},ea86:function(e,t,i){},ef19:function(e,t,i){"use strict";var a=i("4a78"),s=i.n(a);s.a}}]);